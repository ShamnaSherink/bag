var SMI_SingleProductSection=function(){"use strict";class SMI_SingleProductSection2{sectionEl=null;sectionId=null;constructor(_sectionId){if(this.sectionId=_sectionId,this.sectionEl=document.querySelector(`#${_sectionId}`),this.sectionEl===null)return null;this._handleResponsive(),this._submitForm()}_handleResponsive(){const mediaQuery=window.matchMedia("(min-width: 768px)"),tabletChange=e=>{const b1=this.sectionEl.querySelector(".smi-block-container-1"),b2=this.sectionEl.querySelector(".smi-block-container-2"),b3=this.sectionEl.querySelector(".smi-block-container-3");e.matches?b1.after(b2):b3.after(b2)};tabletChange(mediaQuery),mediaQuery.addListener(tabletChange)}getSectionInnerHTML(html,selector){return new DOMParser().parseFromString(html,"text/html").querySelector(selector).innerHTML}getSectionsToRender(){const drawerCart=document.getElementById("smi-drawer-items"),res=[{id:"smi-cart-button",section:"smi-cart-icon-bubble",selector:".shopify-section"}];return drawerCart&&res.push({id:"shopify-section-"+drawerCart.dataset.id,section:drawerCart.dataset.id,selector:".smi-drawer-items_w"}),res}_submitForm(){const forms=this.sectionEl.querySelectorAll(".smi-product-form-add-to-cart");forms.length&&forms.forEach(form=>{form.addEventListener("submit",e=>{e.preventDefault(),form.classList.add("smi-form-loading");const cartObj=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),cartType=window.smiObject?window.smiObject.cartType:"page";let sectionsPayload=this.getSectionsToRender().map(section=>section.section);if(cartObj){let _sectionsPayload=cartObj.getSectionsToRender().map(section=>section.id);sectionsPayload=[...sectionsPayload,..._sectionsPayload]}const config={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};config.headers["X-Requested-With"]="XMLHttpRequest",delete config.headers["Content-Type"];const formData=new FormData(form);formData.append("sections",sectionsPayload),formData.append("sections_url",window.location.pathname),config.body=formData;const formErrorEl=document.querySelector(`#msg_notice_cart_item_added_all_${this.sectionId.replace("smi-","")}`);fetch("/cart/add.js",config).then(response=>response.json()).then(data=>{data?.status==422||data?.message==="Cart Error"?formErrorEl&&(console.log("errr data: ",data),formErrorEl.innerHTML=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10.5" fill="#EB001B" stroke="white"/><rect x="10.5" y="5.73938" width="3" height="8" rx="1.5" fill="white"/><circle cx="12" cy="16.7607" r="1.5" fill="white"/></svg>&nbsp;${data?.description}`,formErrorEl.classList.remove("hide-msg-noti-cart-item")):(this.getSectionsToRender().forEach(section=>{const _sectionEl=document.getElementById(section.id);if(_sectionEl){const _elementToReplace=_sectionEl.querySelector(section.selector);let elementToReplace=null;if(_elementToReplace?elementToReplace=_elementToReplace:elementToReplace=_sectionEl,elementToReplace&&(elementToReplace.innerHTML=this.getSectionInnerHTML(data.sections[section.section],section.selector),typeof SMI_CartDrawer=="function"&&cartType==="drawer"?setTimeout(()=>{const drawerObj=new SMI_CartDrawer(".smi-cart-drawer-1");drawerObj.handleToggle(),drawerObj.openDrawer(),drawerObj.note()},150):window.location.href=window.smiObject.routes.cart_url,data?.sections?.["smi-cart-icon-bubble"])){const numberCartItems=new DOMParser().parseFromString(data?.sections?.["smi-cart-icon-bubble"],"text/html").querySelector(".smi-cart-badges").innerText;form.setAttribute("data-cart-items",numberCartItems)}}}),cartObj?typeof cartObj.renderContents=="function"&&cartObj.renderContents(data):typeof SMI_CartDrawer!="function"&&window.smiObject&&(window.location.href=window.smiObject.routes.cart_url))}).finally(()=>{form.classList.remove("smi-form-loading"),cartObj&&cartObj.classList.contains("is-empty")&&cartObj.classList.remove("is-empty")})})})}}return SMI_SingleProductSection2}();
//# sourceMappingURL=/cdn/shop/t/27/assets/smi-single-product-section.js.map?v=110355727095228256631723118780
